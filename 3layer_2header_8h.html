<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Layers: 3layer/header.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Layers
   </div>
   <div id="projectbrief">Diffusion in heterogeneous environments</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_a6e2e09cf836152d8cb4bbc39bdd8dcc.html">3layer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">header.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Header file for program 3layer.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;stdarg.h&gt;</code><br />
<code>#include &lt;getopt.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;strings.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;math.h&gt;</code><br />
<code>#include &lt;gsl/gsl_multimin.h&gt;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for header.h:</div>
<div class="dyncontent">
<div class="center"><img src="3layer_2header_8h__incl.png" border="0" usemap="#3layer_2header_8h" alt=""/></div>
</div>
</div><div class="textblock"><div class="dynheader">
This graph shows which files directly or indirectly include this file:</div>
<div class="dyncontent">
<div class="center"><img src="3layer_2header_8h__dep__incl.png" border="0" usemap="#3layer_2header_8hdep" alt=""/></div>
<map name="3layer_2header_8hdep" id="3layer_2header_8hdep">
<area shape="rect" id="node2" href="3layer_8c.html" title="Calculates the extracellular concentration of a substance diffusing in an environment consisting of 3..." alt="" coords="5,80,112,107"/>
<area shape="rect" id="node3" href="3layer_2extras_8c.html" title="Extra functions that are useful for 3layer. " alt="" coords="137,80,245,107"/>
<area shape="rect" id="node4" href="io_8c.html" title="Input/output functions that are useful for 3layer. " alt="" coords="269,80,352,107"/>
<area shape="rect" id="node5" href="3layer_2model_8c.html" title="Function for solving the forward problem with the 3&#45;layer model. " alt="" coords="376,80,483,107"/>
<area shape="rect" id="node6" href="rti-theory_8c.html" title="Functions for fitting the homogeneous model to the data (traditional fit) to obtain the apparent para..." alt="" coords="507,80,629,107"/>
</map>
</div>
</div>
<p><a href="3layer_2header_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmse__rti__params__struct__type.html">mse_rti_params_struct_type</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structsource__struct__type.html">source_struct_type</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structmore__sources__struct__type.html">more_sources_struct_type</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aa25019b778f58c8014c2002916b65c8f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa25019b778f58c8014c2002916b65c8f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#aa25019b778f58c8014c2002916b65c8f">MAXNUM_LINES</a>&#160;&#160;&#160;10000</td></tr>
<tr class="memdesc:aa25019b778f58c8014c2002916b65c8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of lines in input file. <br /></td></tr>
<tr class="separator:aa25019b778f58c8014c2002916b65c8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64c06be5af8ee1c7c21d75e58b60656d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a64c06be5af8ee1c7c21d75e58b60656d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a64c06be5af8ee1c7c21d75e58b60656d">MAX_LINELENGTH</a>&#160;&#160;&#160;100</td></tr>
<tr class="memdesc:a64c06be5af8ee1c7c21d75e58b60656d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum length of any line in input file. <br /></td></tr>
<tr class="separator:a64c06be5af8ee1c7c21d75e58b60656d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa938450024c0ff6da723a517c6a5a99c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa938450024c0ff6da723a517c6a5a99c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#aa938450024c0ff6da723a517c6a5a99c">MAXNUM_COMMENTLINES</a>&#160;&#160;&#160;1000</td></tr>
<tr class="memdesc:aa938450024c0ff6da723a517c6a5a99c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of comment lines of input file to copy to output file. <br /></td></tr>
<tr class="separator:aa938450024c0ff6da723a517c6a5a99c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1abcb51a4aa27a5a5a7958c03448134"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af1abcb51a4aa27a5a5a7958c03448134"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#af1abcb51a4aa27a5a5a7958c03448134">MAX_COMMAND_LENGTH</a>&#160;&#160;&#160;1000</td></tr>
<tr class="memdesc:af1abcb51a4aa27a5a5a7958c03448134"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum number of characters of command to copy to output file. <br /></td></tr>
<tr class="separator:af1abcb51a4aa27a5a5a7958c03448134"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf98801251440789ad609124e2b60651"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="adf98801251440789ad609124e2b60651"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#adf98801251440789ad609124e2b60651">ADDITIONAL_SOURCES_STRING_LENGTH</a>&#160;&#160;&#160;500</td></tr>
<tr class="memdesc:adf98801251440789ad609124e2b60651"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximum length of string argument to additional_sources option. <br /></td></tr>
<tr class="separator:adf98801251440789ad609124e2b60651"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa93f0eb578d23995850d61f7d61c55c1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa93f0eb578d23995850d61f7d61c55c1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>&#160;&#160;&#160;0</td></tr>
<tr class="memdesc:aa93f0eb578d23995850d61f7d61c55c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">FALSE assigned to 0. <br /></td></tr>
<tr class="separator:aa93f0eb578d23995850d61f7d61c55c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8cecfc5c5c054d2875c03e77b7be15d"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa8cecfc5c5c054d2875c03e77b7be15d"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>&#160;&#160;&#160;1</td></tr>
<tr class="memdesc:aa8cecfc5c5c054d2875c03e77b7be15d"><td class="mdescLeft">&#160;</td><td class="mdescRight">TRUE assigned to 1. <br /></td></tr>
<tr class="separator:aa8cecfc5c5c054d2875c03e77b7be15d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a598a3330b3c21701223ee0ca14316eca"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a598a3330b3c21701223ee0ca14316eca"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a598a3330b3c21701223ee0ca14316eca">PI</a>&#160;&#160;&#160;(4*atan(1.0))</td></tr>
<tr class="memdesc:a598a3330b3c21701223ee0ca14316eca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Sets constant PI to M_PI if that is defined; otherwise, computes PI as <img class="formulaInl" alt="$ 4 \: tan^{-1}(1) $" src="form_35.png"/>. <br /></td></tr>
<tr class="separator:a598a3330b3c21701223ee0ca14316eca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6d3ffb7936453b4d74b579827bb0ea1"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab6d3ffb7936453b4d74b579827bb0ea1"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#ab6d3ffb7936453b4d74b579827bb0ea1">FARADAY</a>&#160;&#160;&#160;96485.3399</td></tr>
<tr class="memdesc:ab6d3ffb7936453b4d74b579827bb0ea1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Faraday constant in C/mol. <br /></td></tr>
<tr class="separator:ab6d3ffb7936453b4d74b579827bb0ea1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96dcd99bb36a67a871a76b8ee0973a82"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a96dcd99bb36a67a871a76b8ee0973a82"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a96dcd99bb36a67a871a76b8ee0973a82">SMALLNUM</a>&#160;&#160;&#160;2.2204460492503131e-16</td></tr>
<tr class="memdesc:a96dcd99bb36a67a871a76b8ee0973a82"><td class="mdescLeft">&#160;</td><td class="mdescRight">For comparing doubles with 0: Sets SMALLNUM to DBL_EPSILON or to GSL_DBL_EPSILON if they're defined; otherwise set to another small number. <br /></td></tr>
<tr class="separator:a96dcd99bb36a67a871a76b8ee0973a82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a69594b2ea1ac8262ab37a48fe774ff"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0a69594b2ea1ac8262ab37a48fe774ff"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a0a69594b2ea1ac8262ab37a48fe774ff">IS_ZERO</a>(x)&#160;&#160;&#160;(fabs(x) &lt; (<a class="el" href="fit-layer_2header_8h.html#a96dcd99bb36a67a871a76b8ee0973a82">SMALLNUM</a>) ? (<a class="el" href="fit-layer_2header_8h.html#aa8cecfc5c5c054d2875c03e77b7be15d">TRUE</a>) : (<a class="el" href="fit-layer_2header_8h.html#aa93f0eb578d23995850d61f7d61c55c1">FALSE</a>))</td></tr>
<tr class="memdesc:a0a69594b2ea1ac8262ab37a48fe774ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">Evaluates to TRUE if |<em>x|</em> &lt; SMALLNUM, FALSE otherwise. <br /></td></tr>
<tr class="separator:a0a69594b2ea1ac8262ab37a48fe774ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab42511b5b7bf70ad31b13c44469d117f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab42511b5b7bf70ad31b13c44469d117f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#ab42511b5b7bf70ad31b13c44469d117f">STREQ</a>(s1,  s2)&#160;&#160;&#160;(strcmp(s1,s2) == 0)</td></tr>
<tr class="memdesc:ab42511b5b7bf70ad31b13c44469d117f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compares strings <em>s1</em> and <em>s2</em>; evaluates to TRUE if strings are equal, FALSE if not. <br /></td></tr>
<tr class="separator:ab42511b5b7bf70ad31b13c44469d117f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7866fa5e4e0ee9b034e9dab6599a9cc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa7866fa5e4e0ee9b034e9dab6599a9cc"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#aa7866fa5e4e0ee9b034e9dab6599a9cc">SQR</a>(x)&#160;&#160;&#160;((x) * (x))</td></tr>
<tr class="memdesc:aa7866fa5e4e0ee9b034e9dab6599a9cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the square of <em>x</em>. <br /></td></tr>
<tr class="separator:aa7866fa5e4e0ee9b034e9dab6599a9cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacc3ee1a7f283f8ef65cea31f4436a95"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aacc3ee1a7f283f8ef65cea31f4436a95"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#aacc3ee1a7f283f8ef65cea31f4436a95">MAX</a>(x,  y)&#160;&#160;&#160;((x) &gt; (y) ? (x) : (y))</td></tr>
<tr class="memdesc:aacc3ee1a7f283f8ef65cea31f4436a95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the maximum of <em>x</em> and <em>y</em>. <br /></td></tr>
<tr class="separator:aacc3ee1a7f283f8ef65cea31f4436a95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74e75242132eaabbc1c512488a135926"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a74e75242132eaabbc1c512488a135926"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a74e75242132eaabbc1c512488a135926">MIN</a>(x,  y)&#160;&#160;&#160;((x) &lt; (y) ? (x) : (y))</td></tr>
<tr class="memdesc:a74e75242132eaabbc1c512488a135926"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the minimum of <em>x</em> and <em>y</em>. <br /></td></tr>
<tr class="separator:a74e75242132eaabbc1c512488a135926"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a035b1d71c134a8e693dd7702b44c0f93"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a035b1d71c134a8e693dd7702b44c0f93"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a035b1d71c134a8e693dd7702b44c0f93">INDEX</a>(i,  j)&#160;&#160;&#160;((i)*(nr+1)+(j))</td></tr>
<tr class="memdesc:a035b1d71c134a8e693dd7702b44c0f93"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the 1D index for concentration or alpha arrays, given pseudo-2D indices <em>i</em> (z index) and <em>j</em> (r index); uses column-major ordering. <br /></td></tr>
<tr class="separator:a035b1d71c134a8e693dd7702b44c0f93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a57b14ad95d861c8557a95a3371ff5e77"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a57b14ad95d861c8557a95a3371ff5e77"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a57b14ad95d861c8557a95a3371ff5e77">INDEX_FULL_P</a>(i,  j)&#160;&#160;&#160;((i)*(2*nr-1)+nr+(j)-2)</td></tr>
<tr class="memdesc:a57b14ad95d861c8557a95a3371ff5e77"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the 1D index for r &gt;= 0 part of a concentration image, given pseudo-2D indices <em>i</em> (z index) and <em>j</em> (r index); uses column-major ordering. <br /></td></tr>
<tr class="separator:a57b14ad95d861c8557a95a3371ff5e77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1024940d7350970f9e3bed00fb685393"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1024940d7350970f9e3bed00fb685393"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a1024940d7350970f9e3bed00fb685393">INDEX_FULL_N</a>(i,  j)&#160;&#160;&#160;((i)*(2*nr-1)+nr-(j))</td></tr>
<tr class="memdesc:a1024940d7350970f9e3bed00fb685393"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the 1D index for r &gt;= 0 part of a concentration image, given pseudo-2D indices <em>i</em> (z index) and <em>j</em> (r index); uses column-major ordering. <br /></td></tr>
<tr class="separator:a1024940d7350970f9e3bed00fb685393"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5780e5bb42446c7c10613d0b14b61e18"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a5780e5bb42446c7c10613d0b14b61e18">convolve3</a> (int M, int N, double *a, double scale1, double scale2, double *invr, double *out)</td></tr>
<tr class="memdesc:a5780e5bb42446c7c10613d0b14b61e18"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates updates to the concentration in a layer by applying the Laplacian in cylindrical coordinates; also scales by <img class="formulaInl" alt="$ \theta D_{free} $" src="form_24.png"/>.  <a href="#a5780e5bb42446c7c10613d0b14b61e18">More...</a><br /></td></tr>
<tr class="separator:a5780e5bb42446c7c10613d0b14b61e18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69bd8ee4a64db532760bc7bf7c6ba80f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a69bd8ee4a64db532760bc7bf7c6ba80f">error</a> (char *errorstring,...)</td></tr>
<tr class="memdesc:a69bd8ee4a64db532760bc7bf7c6ba80f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print an error message to stderr and exit with status EXIT_FAILURE.  <a href="#a69bd8ee4a64db532760bc7bf7c6ba80f">More...</a><br /></td></tr>
<tr class="separator:a69bd8ee4a64db532760bc7bf7c6ba80f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa3d6d83263f4015feeb9bd7d70a4b180"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#aa3d6d83263f4015feeb9bd7d70a4b180">print_usage</a> (char *program)</td></tr>
<tr class="memdesc:aa3d6d83263f4015feeb9bd7d70a4b180"><td class="mdescLeft">&#160;</td><td class="mdescRight">Print usage message and exit with status EXIT_FAILURE.  <a href="#aa3d6d83263f4015feeb9bd7d70a4b180">More...</a><br /></td></tr>
<tr class="separator:aa3d6d83263f4015feeb9bd7d70a4b180"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a88e2885eeb2f1362d93d66e4e01089a2"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a88e2885eeb2f1362d93d66e4e01089a2">create_array</a> (int N, char *string)</td></tr>
<tr class="memdesc:a88e2885eeb2f1362d93d66e4e01089a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create an array of doubles of the specified size.  <a href="#a88e2885eeb2f1362d93d66e4e01089a2">More...</a><br /></td></tr>
<tr class="separator:a88e2885eeb2f1362d93d66e4e01089a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d41abd9893f83aa04a59322193bfc59"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a8d41abd9893f83aa04a59322193bfc59">get_filename</a> (char *in, char *out)</td></tr>
<tr class="memdesc:a8d41abd9893f83aa04a59322193bfc59"><td class="mdescLeft">&#160;</td><td class="mdescRight">Make sure that the filename is not too long.  <a href="#a8d41abd9893f83aa04a59322193bfc59">More...</a><br /></td></tr>
<tr class="separator:a8d41abd9893f83aa04a59322193bfc59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1040c3c715c63276e542f1ef808e5fd4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a1040c3c715c63276e542f1ef808e5fd4">get_io_filenames</a> (char *argstring, const char *inf_extension, const char *outf_extension, char *infilename, char *outfilename)</td></tr>
<tr class="memdesc:a1040c3c715c63276e542f1ef808e5fd4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine the input filename and the default output file name.  <a href="#a1040c3c715c63276e542f1ef808e5fd4">More...</a><br /></td></tr>
<tr class="separator:a1040c3c715c63276e542f1ef808e5fd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c0855c2e0c0f3cf4fdb07da1b245de9"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a8c0855c2e0c0f3cf4fdb07da1b245de9">assemble_command</a> (int argc, char *argv[], char *command)</td></tr>
<tr class="memdesc:a8c0855c2e0c0f3cf4fdb07da1b245de9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a string containing the command used to run the program.  <a href="#a8c0855c2e0c0f3cf4fdb07da1b245de9">More...</a><br /></td></tr>
<tr class="separator:a8c0855c2e0c0f3cf4fdb07da1b245de9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a110235991675b58df9ef429b49971570"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a110235991675b58df9ef429b49971570">read_source_parameter</a> (char *string, int nsource)</td></tr>
<tr class="memdesc:a110235991675b58df9ef429b49971570"><td class="mdescLeft">&#160;</td><td class="mdescRight">Read a parameter from the string argument to the additional_sources option.  <a href="#a110235991675b58df9ef429b49971570">More...</a><br /></td></tr>
<tr class="separator:a110235991675b58df9ef429b49971570"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a212608d1983521c4294dd0e8b0f307af"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a212608d1983521c4294dd0e8b0f307af">calc_diffusion_curve_layer</a> (int nt, int nz, int nr, int iprobe, int jprobe, int iz1, int iz2, int nolayer, double dt, double dr, double sdelay, double sduration, double alpha_so, double theta_so, double kappa_so, double alpha_sp, double theta_sp, double kappa_sp, double alpha_sr, double theta_sr, double kappa_sr, double dfree, double *t, double *s, double *invr, char *imagebasename, double image_spacing, double *p)</td></tr>
<tr class="memdesc:a212608d1983521c4294dd0e8b0f307af"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the concentration as a function of space and time and returns the probe concentration as a function of time; also outputs the concentration as images if that option was chosen.  <a href="#a212608d1983521c4294dd0e8b0f307af">More...</a><br /></td></tr>
<tr class="separator:a212608d1983521c4294dd0e8b0f307af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33769302c7a24ae68a7ba98d7cb63c3c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#a33769302c7a24ae68a7ba98d7cb63c3c">calc_mse_rti</a> (const gsl_vector *x, void *params)</td></tr>
<tr class="memdesc:a33769302c7a24ae68a7ba98d7cb63c3c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mean squared error function for simplex fitting.  <a href="#a33769302c7a24ae68a7ba98d7cb63c3c">More...</a><br /></td></tr>
<tr class="separator:a33769302c7a24ae68a7ba98d7cb63c3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeba05f11617b83cdada6d5228d1d7475"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="3layer_2header_8h.html#aeba05f11617b83cdada6d5228d1d7475">rti_theory</a> (int nt, double spdist, double samplitude, double sdelay, double sduration, double kappa, double dfree, double alpha, double theta, double *t, double *p_theory)</td></tr>
<tr class="memdesc:aeba05f11617b83cdada6d5228d1d7475"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates RTI data for diffusion in an isotropic, homogeneous environment (direct calculation from an equation)  <a href="#aeba05f11617b83cdada6d5228d1d7475">More...</a><br /></td></tr>
<tr class="separator:aeba05f11617b83cdada6d5228d1d7475"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Header file for program 3layer. </p>
<dl class="section author"><dt>Author</dt><dd>David Lewis, CABI, NKI </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU Public License </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2012-2013 </dd></dl>

<p>Definition in file <a class="el" href="3layer_2header_8h_source.html">header.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a8c0855c2e0c0f3cf4fdb07da1b245de9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int assemble_command </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>command</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a string containing the command used to run the program. </p>
<p>It can be very useful for the program's output file to have a comment line that contains the command used to run the program. This function assembles that command into a string from the argc and argv parameters so it can be added to the output file.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">argc</td><td>Argument count (parameter passed to main) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">argv</td><td>Argument vector (parameter passed to main) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">command</td><td>String containing the command line</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Number of elements on the command line </dd></dl>

<p>Definition at line <a class="el" href="io_8c_source.html#l00091">91</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="3layer_2header_8h_a8c0855c2e0c0f3cf4fdb07da1b245de9_icgraph.png" border="0" usemap="#3layer_2header_8h_a8c0855c2e0c0f3cf4fdb07da1b245de9_icgraph" alt=""/></div>
<map name="3layer_2header_8h_a8c0855c2e0c0f3cf4fdb07da1b245de9_icgraph" id="3layer_2header_8h_a8c0855c2e0c0f3cf4fdb07da1b245de9_icgraph">
<area shape="rect" id="node2" href="3layer_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program. " alt="" coords="196,5,247,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a212608d1983521c4294dd0e8b0f307af"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void calc_diffusion_curve_layer </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iprobe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>jprobe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iz1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>iz2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nolayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sdelay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sduration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_so</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta_so</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kappa_so</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta_sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kappa_sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha_sr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta_sr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kappa_sr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dfree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>invr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>imagebasename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>image_spacing</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the concentration as a function of space and time and returns the probe concentration as a function of time; also outputs the concentration as images if that option was chosen. </p>
<p>This function solves the diffusion equation in each layer <img class="formulaInl" alt="$ k $" src="form_36.png"/> ,</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \frac{\partial c_k(\vec r, t)}{\partial t} = D_{free} \theta_k \nabla^2{c_k(\vec r, t)} + s/\alpha_k - \kappa_k c_k(\vec r, t) \quad , \]" src="form_37.png"/>
</p>
<p>subject to the continuity conditions at the interfaces between layers</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ c(\vec r_k, t) = c(\vec r_{k+1}, t) \quad \]" src="form_38.png"/>
</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \alpha_k \theta_k \nabla c(\vec r_k, t) = \alpha_{k+1} \theta_{k+1} \nabla c(\vec r_{k+1}, t) \quad \]" src="form_39.png"/>
</p>
<p>and the boundary condition <img class="formulaInl" alt="$ c(\vec r, t) = 0 $" src="form_40.png"/> (total absorption) at the top, the bottom, and the side of the cylinder, where</p>
<p><img class="formulaInl" alt="$ c_k(\vec r, t) $" src="form_41.png"/> = concentration in layer <img class="formulaInl" alt="$ k $" src="form_36.png"/></p>
<p><img class="formulaInl" alt="$ D_{free} $" src="form_42.png"/> = free diffusion coefficient</p>
<p><img class="formulaInl" alt="$ \theta_k $" src="form_43.png"/> = permeability in layer <img class="formulaInl" alt="$ k $" src="form_36.png"/></p>
<p><img class="formulaInl" alt="$ s_k(\vec r, t) $" src="form_44.png"/> = source in layer <img class="formulaInl" alt="$ k $" src="form_36.png"/></p>
<p><img class="formulaInl" alt="$ \alpha_k $" src="form_45.png"/> = extracellular volume fraction in layer <img class="formulaInl" alt="$ k $" src="form_36.png"/></p>
<p><img class="formulaInl" alt="$ \kappa_k $" src="form_46.png"/> = nonspecific clearance factor in layer <img class="formulaInl" alt="$ k $" src="form_36.png"/></p>
<p>This function calls <a class="el" href="3layer_2convo_8c.html#a5780e5bb42446c7c10613d0b14b61e18" title="Calculates updates to the concentration in a layer by applying the Laplacian in cylindrical coordinat...">convolve3()</a> to compute the Laplacian in cylindrical coordinates.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nt</td><td>Number of support points in time </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nz</td><td>Number of rows of concentration matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nr</td><td>Number of columns of concentration matrix </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iprobe</td><td>z-index of probe location </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">jprobe</td><td>r-index of probe location </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iz1</td><td>z-index of SR-SP boundary </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">iz2</td><td>z-index of SP-SO boundary </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">nolayer</td><td>Flag for whether to model a single homogeneous environment (true) or to model a 3-layer environment </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dt</td><td>Spacing in time ( <img class="formulaInl" alt="$ t_{i+1} = t_i + \Delta t $" src="form_47.png"/>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dr</td><td>Spacing in r (in this program, <img class="formulaInl" alt="$ \Delta z = \Delta r $" src="form_12.png"/>) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sdelay</td><td>Source delay (time before source starts) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sduration</td><td>Duration of source </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha_so</td><td>Extracellular volume fraction in SO layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">theta_so</td><td>Permeability in SO layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kappa_so</td><td>Nonspecific clearance factor in SO layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha_sp</td><td>Extracellular volume fraction in SP layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">theta_sp</td><td>Permeability in SP layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kappa_sp</td><td>Nonspecific clearance factor in SP layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha_sr</td><td>Extracellular volume fraction in SR layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">theta_sr</td><td>Permeability in SR layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kappa_sr</td><td>Nonspecific clearance factor in SR layer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dfree</td><td>Free diffusion coefficient </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Time array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">s</td><td>Source array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">invr</td><td>Array for <img class="formulaInl" alt="$ 1/r $" src="form_19.png"/> values </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">p</td><td>Probe array (concentration as a function of time) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="3layer_2model_8c_source.html#l00101">101</a> of file <a class="el" href="3layer_2model_8c_source.html">model.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="3layer_2header_8h_a212608d1983521c4294dd0e8b0f307af_cgraph.png" border="0" usemap="#3layer_2header_8h_a212608d1983521c4294dd0e8b0f307af_cgraph" alt=""/></div>
<map name="3layer_2header_8h_a212608d1983521c4294dd0e8b0f307af_cgraph" id="3layer_2header_8h_a212608d1983521c4294dd0e8b0f307af_cgraph">
<area shape="rect" id="node2" href="3layer_2extras_8c.html#a88e2885eeb2f1362d93d66e4e01089a2" title="Create an array of doubles of the specified size. " alt="" coords="195,5,289,32"/>
<area shape="rect" id="node3" href="3layer_2extras_8c.html#a69bd8ee4a64db532760bc7bf7c6ba80f" title="Print an error message to stderr and exit with status EXIT_FAILURE. " alt="" coords="218,56,266,83"/>
<area shape="rect" id="node4" href="3layer_2convo_8c.html#a5780e5bb42446c7c10613d0b14b61e18" title="Calculates updates to the concentration in a layer by applying the Laplacian in cylindrical coordinat..." alt="" coords="201,107,283,133"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="3layer_2header_8h_a212608d1983521c4294dd0e8b0f307af_icgraph.png" border="0" usemap="#3layer_2header_8h_a212608d1983521c4294dd0e8b0f307af_icgraph" alt=""/></div>
<map name="3layer_2header_8h_a212608d1983521c4294dd0e8b0f307af_icgraph" id="3layer_2header_8h_a212608d1983521c4294dd0e8b0f307af_icgraph">
<area shape="rect" id="node2" href="3layer_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program. " alt="" coords="195,13,245,39"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a33769302c7a24ae68a7ba98d7cb63c3c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_mse_rti </td>
          <td>(</td>
          <td class="paramtype">const gsl_vector *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mean squared error function for simplex fitting. </p>
<p>The 3layer program uses a minimization function in GSL to minimize the mean squared error between the diffusion curve calculated from the multilayer model and a diffusion curve calculated from a formula that assumes an isotropic homogeneous environment. It does so to calculate the apparent parameters and characteristic diffusion curve (for comparison purposes).</p>
<p>This function calculates the mean squared error between the two curves. The GSL minimization routine needs the first parameter to be a vector of doubles which represent the parameters to be fit and the second parameter to be a pointer to parameters of the function to fit (rti_theory).</p>
<p>The second parameter actually points to a struct of parameters. The characteristic curve calculated from rti_theory is stored in the p_theory array of this struct.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">x</td><td>Vector of doubles representing parameters to fit (alpha and theta) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">params</td><td>Vector of parameters needed by rti_theory</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Mean squared error between multilayer curve and characteristic curve </dd></dl>

<p>Definition at line <a class="el" href="rti-theory_8c_source.html#l00042">42</a> of file <a class="el" href="rti-theory_8c_source.html">rti-theory.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="3layer_2header_8h_a33769302c7a24ae68a7ba98d7cb63c3c_cgraph.png" border="0" usemap="#3layer_2header_8h_a33769302c7a24ae68a7ba98d7cb63c3c_cgraph" alt=""/></div>
<map name="3layer_2header_8h_a33769302c7a24ae68a7ba98d7cb63c3c_cgraph" id="3layer_2header_8h_a33769302c7a24ae68a7ba98d7cb63c3c_cgraph">
<area shape="rect" id="node2" href="rti-theory_8c.html#aeba05f11617b83cdada6d5228d1d7475" title="Calculates RTI data for diffusion in an isotropic, homogeneous environment (direct calculation from a..." alt="" coords="149,5,225,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="3layer_2header_8h_a33769302c7a24ae68a7ba98d7cb63c3c_icgraph.png" border="0" usemap="#3layer_2header_8h_a33769302c7a24ae68a7ba98d7cb63c3c_icgraph" alt=""/></div>
<map name="3layer_2header_8h_a33769302c7a24ae68a7ba98d7cb63c3c_icgraph" id="3layer_2header_8h_a33769302c7a24ae68a7ba98d7cb63c3c_icgraph">
<area shape="rect" id="node2" href="3layer_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program. " alt="" coords="149,5,200,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a5780e5bb42446c7c10613d0b14b61e18"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void convolve3 </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>M</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>scale2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>invr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates updates to the concentration in a layer by applying the Laplacian in cylindrical coordinates; also scales by <img class="formulaInl" alt="$ \theta D_{free} $" src="form_24.png"/>. </p>
<p>Calculates the update terms</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{out} = s_1 \mathbf{L} * \mathbf{a} + \frac{s_2}{r} \mathbf{D} * \mathbf{a} \qquad (r \neq 0) \]" src="form_25.png"/>
</p>
<p>or</p>
<p class="formulaDsp">
<img class="formulaDsp" alt="\[ \mathbf{out} = s_1 \mathbf{L0} * \mathbf{a} \qquad (r = 0) \]" src="form_26.png"/>
</p>
<p>where</p>
<p><img class="formulaInl" alt="$ \mathbf{out} $" src="form_27.png"/> = output array</p>
<p><img class="formulaInl" alt="$ s_1, s_2 $" src="form_28.png"/> = scaling factors</p>
<p><img class="formulaInl" alt="$ \mathbf{a} $" src="form_29.png"/> = input array (concentration)</p>
<p><img class="formulaInl" alt="$ * $" src="form_30.png"/> means convolution</p>
<p><img class="formulaInl" alt="$ \mathbf{L} $" src="form_31.png"/> = 3x3 Laplace operator (see above)</p>
<p><img class="formulaInl" alt="$ \mathbf{L0} $" src="form_32.png"/> = 3x3 Laplace operator modified for <img class="formulaInl" alt="$ r = 0 $" src="form_20.png"/></p>
<p><img class="formulaInl" alt="$ \mathbf{D} $" src="form_33.png"/> = 3x3 derivative operator for <img class="formulaInl" alt="$ r $" src="form_15.png"/></p>
<p>Note that the index <img class="formulaInl" alt="$ j = 1 $" src="form_34.png"/> corresponds to <img class="formulaInl" alt="$ r = 0 $" src="form_20.png"/>.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">M</td><td>Number of columns of input matrix (z) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>Number of rows of input matrix (r) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">a</td><td>Input matrix (concentration, c) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scale1</td><td>Scaling factor #1 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">scale2</td><td>Scaling factor #2 </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">invr</td><td>Vector of 1/r values </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>Output matrix </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="3layer_2convo_8c_source.html#l00133">133</a> of file <a class="el" href="3layer_2convo_8c_source.html">convo.c</a>.</p>

</div>
</div>
<a class="anchor" id="a88e2885eeb2f1362d93d66e4e01089a2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double* create_array </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>string</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create an array of doubles of the specified size. </p>
<p>Also initialize the array to all 0.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">N</td><td>Number of elements in array </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">string</td><td>String containing a description of the array (for debugging purposes)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Pointer to the new array </dd></dl>

<p>Definition at line <a class="el" href="3layer_2extras_8c_source.html#l00105">105</a> of file <a class="el" href="3layer_2extras_8c_source.html">extras.c</a>.</p>

</div>
</div>
<a class="anchor" id="a69bd8ee4a64db532760bc7bf7c6ba80f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void error </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>errorstring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>...</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print an error message to stderr and exit with status EXIT_FAILURE. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">errorstring</td><td>String containing error message (variable-length argument list, like printf) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="3layer_2extras_8c_source.html#l00020">20</a> of file <a class="el" href="3layer_2extras_8c_source.html">extras.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8d41abd9893f83aa04a59322193bfc59"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_filename </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Make sure that the filename is not too long. </p>
<p>If the input string is not to big, copy it to the output string. Otherwise, exit with an error message. This function is used to check that the user input filename is not too long.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>Input string = the user input filename (or base filename) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>Output string = the input string, if not too long </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="io_8c_source.html#l00025">25</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="3layer_2header_8h_a8d41abd9893f83aa04a59322193bfc59_cgraph.png" border="0" usemap="#3layer_2header_8h_a8d41abd9893f83aa04a59322193bfc59_cgraph" alt=""/></div>
<map name="3layer_2header_8h_a8d41abd9893f83aa04a59322193bfc59_cgraph" id="3layer_2header_8h_a8d41abd9893f83aa04a59322193bfc59_cgraph">
<area shape="rect" id="node2" href="3layer_2extras_8c.html#a69bd8ee4a64db532760bc7bf7c6ba80f" title="Print an error message to stderr and exit with status EXIT_FAILURE. " alt="" coords="149,5,197,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="3layer_2header_8h_a8d41abd9893f83aa04a59322193bfc59_icgraph.png" border="0" usemap="#3layer_2header_8h_a8d41abd9893f83aa04a59322193bfc59_icgraph" alt=""/></div>
<map name="3layer_2header_8h_a8d41abd9893f83aa04a59322193bfc59_icgraph" id="3layer_2header_8h_a8d41abd9893f83aa04a59322193bfc59_icgraph">
<area shape="rect" id="node2" href="3layer_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program. " alt="" coords="317,5,368,32"/>
<area shape="rect" id="node3" href="io_8c.html#a1040c3c715c63276e542f1ef808e5fd4" title="Determine the input filename and the default output file name. " alt="" coords="149,31,269,57"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a1040c3c715c63276e542f1ef808e5fd4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void get_io_filenames </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argstring</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>inf_extension</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>outf_extension</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>infilename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>outfilename</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine the input filename and the default output file name. </p>
<p>From the last argument on the command line, determine the input file name and the default output file name. (If the output file name is specified on the command line, it will be used instead of the default output file name determined here.)</p>
<p>If the argument has an extension, it is the input filename; remove the extension to get the basename and add the default output filename extension to get the default output filename.</p>
<p>If the argument has no extension, it is the basename; then add the default extensions to get the input filename and the default output filename.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">argstring</td><td>Final command-line argument </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">inf_extension</td><td>Default extension for input file </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">outf_extension</td><td>Default extension for output file </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">infilename</td><td>Name of input file </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">outfilename</td><td>Name of output file </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="io_8c_source.html#l00060">60</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="3layer_2header_8h_a1040c3c715c63276e542f1ef808e5fd4_cgraph.png" border="0" usemap="#3layer_2header_8h_a1040c3c715c63276e542f1ef808e5fd4_cgraph" alt=""/></div>
<map name="3layer_2header_8h_a1040c3c715c63276e542f1ef808e5fd4_cgraph" id="3layer_2header_8h_a1040c3c715c63276e542f1ef808e5fd4_cgraph">
<area shape="rect" id="node2" href="io_8c.html#a8d41abd9893f83aa04a59322193bfc59" title="Make sure that the filename is not too long. " alt="" coords="173,5,269,32"/>
<area shape="rect" id="node3" href="3layer_2extras_8c.html#a69bd8ee4a64db532760bc7bf7c6ba80f" title="Print an error message to stderr and exit with status EXIT_FAILURE. " alt="" coords="317,5,365,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="3layer_2header_8h_a1040c3c715c63276e542f1ef808e5fd4_icgraph.png" border="0" usemap="#3layer_2header_8h_a1040c3c715c63276e542f1ef808e5fd4_icgraph" alt=""/></div>
<map name="3layer_2header_8h_a1040c3c715c63276e542f1ef808e5fd4_icgraph" id="3layer_2header_8h_a1040c3c715c63276e542f1ef808e5fd4_icgraph">
<area shape="rect" id="node2" href="3layer_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program. " alt="" coords="173,5,224,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa3d6d83263f4015feeb9bd7d70a4b180"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void print_usage </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>program</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Print usage message and exit with status EXIT_FAILURE. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">program</td><td>String containing the name of the program </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="3layer_2extras_8c_source.html#l00040">40</a> of file <a class="el" href="3layer_2extras_8c_source.html">extras.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="3layer_2header_8h_aa3d6d83263f4015feeb9bd7d70a4b180_icgraph.png" border="0" usemap="#3layer_2header_8h_aa3d6d83263f4015feeb9bd7d70a4b180_icgraph" alt=""/></div>
<map name="3layer_2header_8h_aa3d6d83263f4015feeb9bd7d70a4b180_icgraph" id="3layer_2header_8h_aa3d6d83263f4015feeb9bd7d70a4b180_icgraph">
<area shape="rect" id="node2" href="3layer_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program. " alt="" coords="143,5,193,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a110235991675b58df9ef429b49971570"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double read_source_parameter </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>string</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nsource</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Read a parameter from the string argument to the additional_sources option. </p>
<p>The additional_sources option to 3layer takes several arguments. (The total number of arguments depends on the number of extra sources.) The getopt_long function (used in the <a class="el" href="3layer_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program. ">main()</a> function to parse 3layer's options) takes only one argument per option, so for additional_sources's argument use a string that contains the several arguments that additional_sources needs.</p>
<p>This function uses strtok to parse the string to obtain the next parameter. The two arguments for this function are used only for diagnostic purposes &ndash; if there is an error, the function aborts with an error message that lists these two arguments.</p>
<p>The first element of the string (the number of extra sources) was previously obtained with the first call to strtok, and subsequent calls to strtok (via this function) use NULL rather than the name of the string.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">string</td><td>String containing the type of parameter to be read </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">nsource</td><td>The number of the source whose parameter is being read</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Value of the parameter that is read </dd></dl>

<p>Definition at line <a class="el" href="io_8c_source.html#l00153">153</a> of file <a class="el" href="io_8c_source.html">io.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="3layer_2header_8h_a110235991675b58df9ef429b49971570_cgraph.png" border="0" usemap="#3layer_2header_8h_a110235991675b58df9ef429b49971570_cgraph" alt=""/></div>
<map name="3layer_2header_8h_a110235991675b58df9ef429b49971570_cgraph" id="3layer_2header_8h_a110235991675b58df9ef429b49971570_cgraph">
<area shape="rect" id="node2" href="3layer_2extras_8c.html#a69bd8ee4a64db532760bc7bf7c6ba80f" title="Print an error message to stderr and exit with status EXIT_FAILURE. " alt="" coords="212,5,260,32"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="3layer_2header_8h_a110235991675b58df9ef429b49971570_icgraph.png" border="0" usemap="#3layer_2header_8h_a110235991675b58df9ef429b49971570_icgraph" alt=""/></div>
<map name="3layer_2header_8h_a110235991675b58df9ef429b49971570_icgraph" id="3layer_2header_8h_a110235991675b58df9ef429b49971570_icgraph">
<area shape="rect" id="node2" href="3layer_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program. " alt="" coords="212,5,263,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aeba05f11617b83cdada6d5228d1d7475"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void rti_theory </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>spdist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>samplitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sdelay</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sduration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kappa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dfree</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>p_theory</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates RTI data for diffusion in an isotropic, homogeneous environment (direct calculation from an equation) </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000001">Todo:</a></b></dt><dd>Change formula to take kappa into account</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">nt</td><td>Number of time points of calculation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">spdist</td><td>Distance between source and probe </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">samplitude</td><td>Amplitude of source </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sdelay</td><td>Source delay (time before source starts) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sduration</td><td>Duration of source </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">kappa</td><td>Nonspecific clearance factor </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dfree</td><td>Free diffusion coefficient </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">alpha</td><td>Extracellular volume fraction </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">theta</td><td>Permeability </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">t</td><td>Time array </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">p_theory</td><td>Probe array (concentration as a function of time) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="rti-theory_8c_source.html#l00088">88</a> of file <a class="el" href="rti-theory_8c_source.html">rti-theory.c</a>.</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="3layer_2header_8h_aeba05f11617b83cdada6d5228d1d7475_icgraph.png" border="0" usemap="#3layer_2header_8h_aeba05f11617b83cdada6d5228d1d7475_icgraph" alt=""/></div>
<map name="3layer_2header_8h_aeba05f11617b83cdada6d5228d1d7475_icgraph" id="3layer_2header_8h_aeba05f11617b83cdada6d5228d1d7475_icgraph">
<area shape="rect" id="node2" href="rti-theory_8c.html#a33769302c7a24ae68a7ba98d7cb63c3c" title="Mean squared error function for simplex fitting. " alt="" coords="129,5,225,32"/>
<area shape="rect" id="node3" href="3layer_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program. " alt="" coords="273,5,324,32"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 6 2017 18:21:12 for Layers by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
