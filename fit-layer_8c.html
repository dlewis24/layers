<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Layers: fit-layer/fit-layer.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Layers
   </div>
   <div id="projectbrief">Diffusion in heterogeneous environments</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_b4ca713c60088079f8b54a82f5801e3c.html">fit-layer</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fit-layer.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Fits the 3-layer model to RTI data to determine alpha, theta, and kappa of the SP layer.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;stdlib.h&gt;</code><br />
<code>#include &lt;getopt.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;strings.h&gt;</code><br />
<code>#include &lt;time.h&gt;</code><br />
<code>#include &lt;gsl/gsl_multimin.h&gt;</code><br />
<code>#include &quot;<a class="el" href="fit-layer_2header_8h_source.html">header.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for fit-layer.c:</div>
<div class="dyncontent">
<div class="center"><img src="fit-layer_8c__incl.png" border="0" usemap="#fit-layer_2fit-layer_8c" alt=""/></div>
<map name="fit-layer_2fit-layer_8c" id="fit-layer_2fit-layer_8c">
<area shape="rect" id="node9" href="fit-layer_2header_8h.html" title="Header file for program fit&#45;layer. " alt="" coords="693,80,765,107"/>
</map>
</div>
</div>
<p><a href="fit-layer_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structparam__struct__type.html">param_struct_type</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Typedef for struct for passing parameters and arrays to mse function.  <a href="structparam__struct__type.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ae393006c464adf9b2e757283c51c8c6e"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fit-layer_8c.html#ae393006c464adf9b2e757283c51c8c6e">calc_mse_fit_layer</a> (const gsl_vector *x, void *params)</td></tr>
<tr class="memdesc:ae393006c464adf9b2e757283c51c8c6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Mean squared error function for simplex fitting.  <a href="#ae393006c464adf9b2e757283c51c8c6e">More...</a><br /></td></tr>
<tr class="separator:ae393006c464adf9b2e757283c51c8c6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0ddf1224851353fc92bfbff6f499fa97"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="fit-layer_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="memdesc:a0ddf1224851353fc92bfbff6f499fa97"><td class="mdescLeft">&#160;</td><td class="mdescRight">Main program. <br /></td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Fits the 3-layer model to RTI data to determine alpha, theta, and kappa of the SP layer. </p>
<p>Usage: </p><pre class="fragment">    fit-layer [options] \&lt;input_file\&gt;
</pre><p>where &lt;input_file&gt; is the name of the input data file. The output file will have the same basename as the input file but will have the extension '.dat'. The input file should not have the extension '.dat'.</p>
<p>To get a list of options, run fit-layer with no input filename.</p>
<p>The input data file consists of:</p><ul>
<li>Header<ul>
<li>Comment lines begin with '#'</li>
<li>Lines assigning parameter values look like "parameter = value [optional trailing text]"</li>
</ul>
</li>
<li>Two blank lines</li>
<li>Data = 2 (or more) columns with a heading:<ul>
<li>First column = time (s)</li>
<li>Second column = concentration (mM)</li>
</ul>
</li>
</ul>
<p>Notes:</p><ul>
<li>Units are always m^2/s for dfree, nA for current, s for duration, and microns for distance &ndash; no matter what appears in the optional trailing text</li>
<li>If there are more than 2 columns, only the first two columns are read; additional columns are skipped</li>
<li>Parameter values specified on the command line override parameter values specified in the input file</li>
<li>Based on the IDL program layer.pro by Jan Hrabe, CABI, NKI</li>
</ul>
<dl class="section author"><dt>Author</dt><dd>David Lewis, CABI, NKI </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>GNU Public License </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2012-2013 </dd></dl>

<p>Definition in file <a class="el" href="fit-layer_8c_source.html">fit-layer.c</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ae393006c464adf9b2e757283c51c8c6e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double calc_mse_fit_layer </td>
          <td>(</td>
          <td class="paramtype">const gsl_vector *&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>params</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Mean squared error function for simplex fitting. </p>
<p>Calls <a class="el" href="fit-layer_2header_8h.html#a80cc3acbd36dbec1b61902fca23a36f8" title="Calculates the concentration as a function of space and time and returns the probe concentration as a...">calc_diffusion_curve_layer_fit_layer()</a>, which calculates the diffusion curve from the layer model. Calculates and returns the MSE between the model curve and the data from experiment.</p>
<p>Note that the data typically has about 1000 samples, but the model curve generally has several thousand points. In order to calculate the mean squared error, the model curve is downsampled to the same number of sample points as in the data.</p>
<dl class="section author"><dt>Author</dt><dd>Dave Lewis, CABI, NKI</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in,out]</td><td class="paramname">x</td><td>Vector of parameters to fit (alpha, theta, kappa of SP) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">params</td><td>Struct of parameters and arrays (e.g., geometry of environment, nt, time array, data array, model curve array)</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Mean squared error between model and data; the model data is returned in an array in the params struct </dd></dl>

<p>Definition at line <a class="el" href="fit-layer_8c_source.html#l00116">116</a> of file <a class="el" href="fit-layer_8c_source.html">fit-layer.c</a>.</p>

<p><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="fit-layer_8c_ae393006c464adf9b2e757283c51c8c6e_cgraph.png" border="0" usemap="#fit-layer_8c_ae393006c464adf9b2e757283c51c8c6e_cgraph" alt=""/></div>
<map name="fit-layer_8c_ae393006c464adf9b2e757283c51c8c6e_cgraph" id="fit-layer_8c_ae393006c464adf9b2e757283c51c8c6e_cgraph">
<area shape="rect" id="node2" href="fit-layer_2header_8h.html#a80cc3acbd36dbec1b61902fca23a36f8" title="Calculates the concentration as a function of space and time and returns the probe concentration as a..." alt="" coords="184,49,325,90"/>
<area shape="rect" id="node3" href="3layer_2extras_8c.html#a88e2885eeb2f1362d93d66e4e01089a2" title="Create an array of doubles of the specified size. " alt="" coords="373,5,468,32"/>
<area shape="rect" id="node4" href="3layer_2extras_8c.html#a69bd8ee4a64db532760bc7bf7c6ba80f" title="Print an error message to stderr and exit with status EXIT_FAILURE. " alt="" coords="397,56,445,83"/>
<area shape="rect" id="node5" href="3layer_2convo_8c.html#a5780e5bb42446c7c10613d0b14b61e18" title="Calculates updates to the concentration in a layer by applying the Laplacian in cylindrical coordinat..." alt="" coords="380,107,461,133"/>
</map>
</div>
</p>

<p><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="fit-layer_8c_ae393006c464adf9b2e757283c51c8c6e_icgraph.png" border="0" usemap="#fit-layer_8c_ae393006c464adf9b2e757283c51c8c6e_icgraph" alt=""/></div>
<map name="fit-layer_8c_ae393006c464adf9b2e757283c51c8c6e_icgraph" id="fit-layer_8c_ae393006c464adf9b2e757283c51c8c6e_icgraph">
<area shape="rect" id="node2" href="fit-layer_8c.html#a0ddf1224851353fc92bfbff6f499fa97" title="Main program. " alt="" coords="184,5,235,32"/>
</map>
</div>
</p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Aug 6 2017 18:21:12 for Layers by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
